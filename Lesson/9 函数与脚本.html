<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>9 函数与脚本</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}
#wmd-preview h2  {
    color: #AAAAFF; /* 将标题改为色 */
}
#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}
#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}
#wmd-preview h3  {
    color: #0077bb; /* 将标题改为蓝色 */
}
#wmd-preview h4  {
    color: #0077bb; /* 将标题改为light blue */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="kj9k" id="9-函数与脚本">9 函数与脚本</h1><p data-anchor-id="6p2c"><code>bash</code></p><hr><div class="md-section-divider"></div><h1 data-anchor-id="i3bh" id="定义function">定义function</h1><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="edfu"><ol class="linenums"><li class="L0"><code><span class="pln">h</span><span class="pun">(){</span><span class="pln"> echo hi</span><span class="pun">;</span><span class="pln">echo $1</span><span class="pun">;</span><span class="pln"> echo $2</span><span class="pun">;}</span></code></li><li class="L1"><code><span class="pln">h</span><span class="pun">(){</span><span class="pln"> echo hi $1 $2</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span></code></li><li class="L2"><code><span class="pln">h</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">   echo hi</span></code></li><li class="L4"><code><span class="pln">   $1</span></code></li><li class="L5"><code><span class="pln">   $</span></code></li><li class="L6"><code><span class="pln"> </span><span class="pun">}</span></code></li><li class="L7"><code><span class="pln"> h wt</span></code></li><li class="L8"><code><span class="pln"> h wt wt</span></code></li></ol></pre><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="834l"><ol class="linenums"><li class="L0"><code><span class="pln">h</span><span class="pun">(){</span><span class="pln"> echo hi</span><span class="pun">;</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> echo $1</span><span class="pun">;</span><span class="pln"> echo $2</span><span class="pun">;}</span></code></li><li class="L1"><code><span class="pln">h </span><span class="lit">1</span><span class="pln"> </span><span class="lit">2</span></code></li></ol></pre><p data-anchor-id="3hry">$1一次只能传一个变量</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="xgfy"><ol class="linenums"><li class="L0"><code><span class="pln">h</span><span class="pun">(){</span><span class="pln"> echo hi $1 $2 $3</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span></code></li><li class="L1"><code><span class="pln">h </span><span class="str">`seq 10`</span></code></li><li class="L2"><code><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="lit">3</span></code></li></ol></pre><p data-anchor-id="rfn5">定义一个function为变量</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="r776"><ol class="linenums"><li class="L0"><code><span class="pln">h</span><span class="pun">(){</span><span class="pln"> echo </span><span class="str">`seq 10`</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span></code></li><li class="L1"><code><span class="pln">h</span></code></li></ol></pre><p data-anchor-id="vjhz">比较</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="h72g"><ol class="linenums"><li class="L0"><code><span class="pln">j</span><span class="pun">=</span><span class="str">"echo `seq 10`"</span></code></li><li class="L1"><code><span class="pln">$j</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="rqg6" id="局部变量">局部变量</h2><p data-anchor-id="ps5n">use <code>local</code> to identify a vector only in a function</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="uhy3"><ol class="linenums"><li class="L0"><code><span class="pln">x</span><span class="pun">(){</span><span class="pln"> a</span><span class="pun">=</span><span class="lit">3</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span></code></li><li class="L1"><code><span class="pln">x</span></code></li><li class="L2"><code><span class="pln">echo $a</span></code></li></ol></pre><p data-anchor-id="cdb2">local</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="uwou"><ol class="linenums"><li class="L0"><code><span class="pln">unset a</span></code></li><li class="L1"><code><span class="pln">x</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">local</span><span class="pln"> a</span><span class="pun">=</span><span class="lit">3</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span></code></li><li class="L2"><code><span class="pln">x</span></code></li><li class="L3"><code><span class="pln">echo $a</span></code></li></ol></pre><p data-anchor-id="kvov">paste  <code>$2</code> in <code>$1</code> times without space</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="t4uf"><ol class="linenums"><li class="L0"><code><span class="pln">x</span><span class="pun">(){</span></code></li><li class="L1"><code><span class="pln">    </span><span class="kwd">local</span><span class="pln"> a</span><span class="pun">=</span><span class="str">""</span></code></li><li class="L2"><code><span class="pln">    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> </span><span class="str">`seq $1`</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">do</span></code></li><li class="L3"><code><span class="pln">        a</span><span class="pun">=</span><span class="str">"$a$2"</span><span class="pln"> </span><span class="com">#meet problem when we deal with space</span></code></li><li class="L4"><code><span class="pln">    </span><span class="kwd">done</span></code></li><li class="L5"><code><span class="pln">    echo $a</span></code></li><li class="L6"><code><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L7"><code><span class="pun">}</span></code></li><li class="L8"><code><span class="pln">x </span><span class="lit">10</span><span class="pln"> </span><span class="lit">3</span></code></li><li class="L9"><code><span class="pln">x </span><span class="lit">10</span><span class="pln"> </span><span class="str">"*"</span></code></li><li class="L0"><code><span class="pln">x </span><span class="lit">10</span><span class="pln"> </span><span class="str">"\*"</span></code></li></ol></pre><div class="md-section-divider"></div><h1 data-anchor-id="w3oy" id="bash脚本">bash脚本</h1><p data-anchor-id="i0t6">vim aaa.sh 打开一个bash脚本 <br>
函数与脚本中的参数列表，就是一个数组，只是没有指定名字，所以要用$来访问</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="1vg6"><ol class="linenums"><li class="L0"><code><span class="pln">f</span><span class="pun">(){</span></code></li><li class="L1"><code><span class="pln">echo $0 $1 $2 $3 </span><span class="com">#$0 == file itself</span></code></li><li class="L2"><code><span class="pln">echo $@ </span><span class="com">#all the arguments</span></code></li><li class="L3"><code><span class="pln">echo $</span><span class="pun">*</span><span class="pln"> </span><span class="com">#the same as above</span></code></li><li class="L4"><code><span class="pun">}</span></code></li><li class="L5"><code><span class="pln">f </span><span class="lit">1</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="lit">5</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">echo </span><span class="str">"-------------"</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pln">echo $0 $1 $2 $3</span></code></li><li class="L0"><code><span class="pln">echo $@</span></code></li><li class="L1"><code><span class="pln">echo $</span><span class="pun">*</span></code></li><li class="L2"><code><span class="pun">}</span></code></li></ol></pre><p data-anchor-id="sfz5">run in bash</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="y0ch"><ol class="linenums"><li class="L0"><code><span class="pln">bash aaa</span><span class="pun">.</span><span class="pln">sh</span></code></li><li class="L1"><code><span class="pln">cat aaa</span><span class="pun">.</span><span class="pln">sh</span></code></li><li class="L2"><code><span class="pln">bash aaa</span><span class="pun">.</span><span class="pln">sh a b c d e</span></code></li></ol></pre><div class="md-section-divider"></div><h1 data-anchor-id="pv76" id="return-in-function">return in function</h1><p data-anchor-id="7mgh">In bash, the result of a function is the ouput of a function  <br>
<code>return</code> only represents a signal how the function run <br>
0 == run correctly  ; 123 == error</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ea9b"><ol class="linenums"><li class="L0"><code><span class="pln">x</span><span class="pun">=(){</span><span class="pln"> echo hi</span><span class="pun">;</span><span class="pln"> echoo </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">3</span><span class="pun">}</span></code></li><li class="L1"><code><span class="pln">echo $</span><span class="pun">?</span></code></li></ol></pre><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ml7c"><ol class="linenums"><li class="L0"><code><span class="pln">x</span></code></li><li class="L1"><code><span class="pln">echo $</span><span class="pun">?</span></code></li><li class="L2"><code><span class="pln">a</span><span class="pun">=</span><span class="str">`x`</span><span class="pln"> </span><span class="com">#only put the output of x in a;the error output will be print on screen</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="pln">echo $a </span><span class="com">#only </span></code></li></ol></pre><p data-anchor-id="8wek">use redirection to put error output into a</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="90ey"><ol class="linenums"><li class="L0"><code><span class="pln">a</span><span class="pun">=</span><span class="str">`x 2&gt;&amp;1`</span></code></li><li class="L1"><code><span class="pln">echo $a</span></code></li></ol></pre><p data-anchor-id="r7hs">little try on redirection again</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="yi2x"><ol class="linenums"><li class="L0"><code><span class="pln">a</span><span class="pun">=</span><span class="pln">$</span><span class="pun">(</span><span class="pln">echo hi</span><span class="pun">;</span><span class="pln"> echo </span><span class="lit">123</span><span class="pln"> </span><span class="pun">&gt;&amp;</span><span class="lit">2</span><span class="pun">)</span></code></li><li class="L1"><code><span class="pln">echo $a</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">a</span><span class="pun">=</span><span class="str">`echo hi; echo 123 &gt; &amp;2`</span></code></li></ol></pre></div>
</body>
</html>